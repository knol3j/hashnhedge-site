{{/*
  This partial is auto-included by PaperMod's head.html.
  - Injects AdSense script only when ads are enabled and in production (or ADS_ENABLED=1).
  - Injects NewsArticle JSON-LD for pages in the configured news section.
*/}}

{{ $adsEnabled := and (site.Params.ads.enabled) (or (hugo.IsProduction) (eq (getenv "ADS_ENABLED") "1")) }}

{{ if $adsEnabled }}
  {{ with site.Params.ads.client_id }}
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client={{ . }}" crossorigin="anonymous"></script>
  {{ end }}
{{ end }}

{{/* NewsArticle JSON-LD only on single pages within the news section */}}
{{ $newsSection := default "news" site.Params.news.section }}
{{ if and .IsPage (eq .Section $newsSection) }}
  {{ partial "news_article.jsonld.html" . }}
{{ end }}
